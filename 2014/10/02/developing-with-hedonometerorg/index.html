<!DOCTYPE html>
<html lang="en">

<head>
    <title>andy reagan</title>
    <meta charset="utf-8" />
    <META HTTP-EQUIV="CACHE-CONTROL" CONTENT="NO-CACHE">



<meta name="tags" contents="hedonometer" />
<meta name="tags" contents="sysadmin" />

    <link rel="stylesheet" type="text/css" href="/theme/css/bootstrap.css">
    <link rel="stylesheet" type="text/css" href="/theme/css/beemuse.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="/theme/css/base.css">
    <!-- <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.2/styles/default.min.css"> -->
    <!-- <script src="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.2/highlight.min.js"></script> -->
</head>

<body>

    <section id="navbar">
        <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
            <div class="container">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="/index.html">andyreagan.com</a>
                </div>
                <div class="collapse navbar-collapse">
                    <ul class="nav navbar-nav">
                        <li ><a href="/pages/blog.html">Blog</a></li>
                        <li ><a href="/pages/about-me.html">About</a></li>
                        <li ><a href="/pages/publications.html">Publications</a></li>
                        <li ><a href="/pages/teaching.html">Teaching</a></li>
                        <li ><a href="/pages/visualizations.html">Visualizations</a></li>
                    </ul>
                </div>
                <!--/.nav-collapse -->
            </div>
        </div>
    </section>

<br>
<section class="content">
    <div class="row">

        <div class="col-xs-12 col-md-8  col-md-offset-2 col-lg-6 col-lg-offset-3">
            <div class="paper">
                <header>
                    <h2 class="entry-title">
                        <a href="https://andyreagan.github.io/2014/10/02/developing-with-hedonometerorg/" rel="bookmark" title="Permalink to Developing with hedonometer.org">Developing with hedonometer.org</a></h2>
                    
                </header>
                <footer class="post-info">
                    <abbr class="published" title="2014-10-02T00:00:00+02:00">
                        Thu 02 October 2014
                    </abbr>
                    &nbsp;
                    &nbsp;
                    <a href="https://github.com/andyreagan/andyreagan.github.io/edit/main/content/2014-10-12-developing-hedonometer.md">Edit on Github</a>
                    <abbr class="modified" title="2019-12-30T00:00:00+01:00">
                        Mon 30 December 2019
                    </abbr>
                </footer><!-- /.post-info -->
                <br>
                <div class="entry-content">
                    <p>~This is a draft.~</p>
<p>Edit: 2019-12-30 this <em>was</em> a draft, I'm just going to publish it.</p>
<p>Long story short, you'll need to clone the git repository on bitbucket (if you don't have a bitbucket account let me know and I'll move it to github, they're the same kind of thing).
Then you can add a remote that is the linode, (you ssh keys are already in all of the new user accounts on the linode under which the apps run), change the code, and then push to the linode.</p>
<p>For me editing the master branch (this is fine since you're just changing text) looks like:</p>
<div class="highlight"><pre><span></span><code>git<span class="w"> </span>pull<span class="w"> </span>origin<span class="w"> </span>master<span class="w"> </span><span class="c1"># update the local version</span>
<span class="nb">source</span><span class="w"> </span>pyenv/bin/activate<span class="w"> </span><span class="c1"># initialize python virtual environment</span>
./manage.py<span class="w"> </span>runserver<span class="w"> </span><span class="m">54043</span>
<span class="c1"># edit the code</span>
<span class="c1"># all the changes are viewable at 127.0.0.1:54043</span>
C-c<span class="w"> </span><span class="c1"># to close the server</span>
git<span class="w"> </span>status<span class="w"> </span><span class="c1"># check what you changed</span>
git<span class="w"> </span>add<span class="w"> </span>newfile.html<span class="w"> </span><span class="c1"># add any new files</span>
git<span class="w"> </span>commit<span class="w"> </span>-am<span class="w"> </span><span class="s2">&quot;simple commit&quot;</span><span class="w"> </span><span class="c1"># commit all changes to watched files</span>
git<span class="w"> </span>push<span class="w"> </span>origin<span class="w"> </span>master<span class="w"> </span><span class="c1"># push to the bitbucket</span>
git<span class="w"> </span>push<span class="w"> </span>production<span class="w"> </span>master<span class="w"> </span><span class="c1"># push to the linode</span>
</code></pre></div>

<p>The remote should look like:</p>
<div class="highlight"><pre><span></span><code>happy%<span class="w"> </span>git<span class="w"> </span>remote<span class="w"> </span>-v
origin<span class="w"> </span>https://andrewreagan@bitbucket.org/andrewreagan/linode-backup.git<span class="w"> </span><span class="o">(</span>fetch<span class="o">)</span>
origin<span class="w"> </span>https://andrewreagan@bitbucket.org/andrewreagan/linode-backup.git<span class="w"> </span><span class="o">(</span>push<span class="o">)</span>
production<span class="w"> </span>prod@hedonometer.org:prod.git<span class="w"> </span><span class="o">(</span>fetch<span class="o">)</span>
production<span class="w"> </span>prod@hedonometer.org:prod.git<span class="w"> </span><span class="o">(</span>push<span class="o">)</span>
<span class="nb">test</span><span class="w"> </span>dev@hedonometer.org:dev.git<span class="w"> </span><span class="o">(</span>fetch<span class="o">)</span>
<span class="nb">test</span><span class="w"> </span>dev@hedonometer.org:dev.git<span class="w"> </span><span class="o">(</span>push<span class="o">)</span>
</code></pre></div>

<p>Which is setup with <code>git remote add production prod@hedonometer.org:prod.git</code>.</p>
<p>The specific files that you'll want to edit are in <code>hedonometer/templates/hedonometer/*.html</code>.
Once you've cloned the repository, you can set up the virtual python environment using <code>virtualenv pyenv</code>, installed from <code>brew install virtualenv</code>. Then source the virtualenv, and use pip to install the following:</p>
<div class="highlight"><pre><span></span><code><span class="n">Django</span><span class="o">==</span><span class="mf">1.6</span>
<span class="n">South</span>
<span class="n">django</span><span class="o">-</span><span class="n">tastypie</span>
<span class="n">django</span><span class="o">-</span><span class="n">sekizai</span>
<span class="n">MySQL</span><span class="o">-</span><span class="n">python</span>
</code></pre></div>

<p>Oh, also, for the site to run locally, you need a local mysql server and to put the connection settings into your environment. Getting the mysql server running (installed with <code>brew install mysql</code>) was annoying at best, but then once you've got it running and created a database, my local environment settings are in a .env file in the repository:</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">DJ_SECRET_KEY</span><span class="o">=</span>******
<span class="nb">export</span><span class="w"> </span><span class="nv">DJ_DEBUG</span><span class="o">=</span><span class="m">1</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">DJ_DB_ENGINE</span><span class="o">=</span>django.db.backends.mysql
<span class="nb">export</span><span class="w"> </span><span class="nv">DJ_DB_NAME</span><span class="o">=</span>testdb
<span class="nb">export</span><span class="w"> </span><span class="nv">DJ_DB_USER</span><span class="o">=</span>root
<span class="nb">export</span><span class="w"> </span><span class="nv">DJ_DB_PASSWORD</span><span class="o">=</span>arret3
<span class="nb">export</span><span class="w"> </span><span class="nv">DJ_DB_HOST</span><span class="o">=</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">DJ_DB_PORT</span><span class="o">=</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">DJ_STATIC_ROOT</span><span class="o">=</span>/Users/andyreagan/work/2014/2014-09hedonometer/mysite/static
<span class="nb">alias</span><span class="w"> </span><span class="nv">minify</span><span class="o">=</span><span class="s2">&quot;yuicompressor&quot;</span>
</code></pre></div>

<p>So...wow that sounds a lot more complicated than I thought it would be.</p>
<p>A lot of the fuss is to get the site running locally, but as long as you don't need to see changes until they're on the site, you wouldn't need to get the site running locally...you could just clone the git repository, and push changes up the site.</p>
                </div> <!-- /.entry-content -->
            </div> <!-- /.paper -->
        </div> <!-- /.col -->
    </div> <!-- /.row -->
</section><!-- /#content -->

    <footer id="slidingfooter" class="body">
        Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>. Site design by Andy Reagan.
    </footer><!-- /#contentinfo -->
</body>
</script>

</html>