<!DOCTYPE html>
<html lang="en">

<head>
    <title>andy reagan</title>
    <meta charset="utf-8" />
    <META HTTP-EQUIV="CACHE-CONTROL" CONTENT="NO-CACHE">



<meta name="tags" contents="git" />

    <link rel="stylesheet" type="text/css" href="/theme/css/bootstrap.css">
    <link rel="stylesheet" type="text/css" href="/theme/css/beemuse.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="/theme/css/base.css">
    <!-- <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.2/styles/default.min.css"> -->
    <!-- <script src="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.2/highlight.min.js"></script> -->
</head>

<body>

    <section id="navbar">
        <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
            <div class="container">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="/index.html">andyreagan.com</a>
                </div>
                <div class="collapse navbar-collapse">
                    <ul class="nav navbar-nav">
                        <li ><a href="/pages/blog.html">Blog</a></li>
                        <li ><a href="/pages/about-me.html">About</a></li>
                        <li ><a href="/pages/publications.html">Publications</a></li>
                        <li ><a href="/pages/teaching.html">Teaching</a></li>
                        <li ><a href="/pages/visualizations.html">Visualizations</a></li>
                    </ul>
                </div>
                <!--/.nav-collapse -->
            </div>
        </div>
    </section>

<br>
<section class="content">
    <div class="row">

        <div class="col-xs-12 col-md-8  col-md-offset-2 col-lg-6 col-lg-offset-3">
            <div class="paper">
                <header>
                    <h2 class="entry-title">
                        <a href="https://andyreagan.github.io/2015/07/09/cross-repository-version-control-using-symbolic-links/" rel="bookmark" title="Permalink to Cross repository version control, using symbolic links">Cross repository version control, using symbolic links</a></h2>
                    
                </header>
                <footer class="post-info">
                    <abbr class="published" title="2015-07-09T00:00:00+02:00">
                        Thu 09 July 2015
                    </abbr>
                    &nbsp;
                    &nbsp;
                    <a href="https://github.com/andyreagan/andyreagan.github.io/edit/main/content/2015-07-09-cross-git-versioning.md">Edit on Github</a>
                </footer><!-- /.post-info -->
                <br>
                <div class="entry-content">
                    <p>So, you've been writing lots and lots of awesome code.
As your codebase amasses, you can rely on snippets that you've already written, in different projects, by copying them around and upgrading as you go: productivity++.
And, because you're a good person, you use <code>git</code> to version control your projects.</p>
<p>But now, you have so many cool functions that you want to use them everything, and are left with 20 different versions across projects, each with the their own goodies.
Combining them into one library is painstaking, but you do it, and import that library into each of your projects.</p>
<p>Every time you upgrade it for a project, you have to load the latest version into each project, and make sure it all still works.
The pain of updating and versioning your own code has overwhelmed you.</p>
<p>So you put all the shared code into it's own project, and symbolically link it from all of your other projects.
Success!
But now, when you upload to github, and deploy through git, only the link get's included, and not the file.
Damnit!</p>
<p>Git doesn't follow symbolic links and this is generally good practice.
But, you need it to.
Here is my super ugly solution: use the <code>.git/hooks/pre-commit</code> and <code>post-commit</code> to replace the links with the files, commit, then replaces the files back with the links!
Only problem now is that <code>git</code> thinks that the mode has changed between every commit...too bad.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># .git/hooks/pre-commit</span>
<span class="c1">#!/bin/sh</span>
<span class="nv">LINKED_DIR</span><span class="o">=</span>/Users/andyreagan/work/2015/07-hedotools/js
<span class="nb">cd</span><span class="w"> </span><span class="nv">$GIT_DIR</span>
<span class="nb">cd</span><span class="w"> </span>..
<span class="k">for</span><span class="w"> </span>FILE<span class="w"> </span><span class="k">in</span><span class="w"> </span>d3.andy.js<span class="w"> </span>hedotools.init.js<span class="w"> </span>hedotools.shifter.js<span class="w"> </span>topojson.js<span class="w"> </span>urllib.js
<span class="k">do</span>
<span class="se">\r</span>m<span class="w"> </span>js/<span class="nv">$FILE</span>
cp<span class="w"> </span><span class="nv">$LINKED_DIR</span>/<span class="nv">$FILE</span><span class="w"> </span>js
git<span class="w"> </span>add<span class="w"> </span>js/<span class="nv">$FILE</span>
<span class="k">done</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="c1"># .git/hooks/post-commit</span>
<span class="c1">#!/bin/sh</span>
<span class="nv">LINKED_DIR</span><span class="o">=</span>/Users/andyreagan/work/2015/07-hedotools/js
<span class="nb">cd</span><span class="w"> </span><span class="nv">$GIT_DIR</span>
<span class="nb">cd</span><span class="w"> </span>../js

<span class="c1"># now, copy over the files</span>
<span class="k">for</span><span class="w"> </span>FILE<span class="w"> </span><span class="k">in</span><span class="w"> </span>d3.andy.js<span class="w"> </span>hedotools.init.js<span class="w"> </span>hedotools.shifter.js<span class="w"> </span>topojson.js<span class="w"> </span>urllib.js
<span class="k">do</span>
<span class="se">\r</span>m<span class="w"> </span><span class="nv">$FILE</span>
ln<span class="w"> </span>-s<span class="w"> </span><span class="nv">$LINKED_DIR</span>/<span class="nv">$FILE</span><span class="w"> </span><span class="nv">$FILE</span>
<span class="k">done</span>
</code></pre></div>
                </div> <!-- /.entry-content -->
            </div> <!-- /.paper -->
        </div> <!-- /.col -->
    </div> <!-- /.row -->
</section><!-- /#content -->

    <footer id="slidingfooter" class="body">
        Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>. Site design by Andy Reagan.
    </footer><!-- /#contentinfo -->
</body>
</script>

</html>